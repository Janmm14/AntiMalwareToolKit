package optic_fusion1.antimalwaretoolkit.tool.impl;

import java.io.File;
import java.io.IOException;
import java.util.zip.ZipFile;
import optic_fusion1.antimalwaretoolkit.tool.Tool;

public class CleanupInvalidFiles extends Tool {

  @Override
  public void run(String[] args) {
    for (File file : new File(args.length == 0 ? "." : args[0]).listFiles()) {
      if (file.length() == 0L) {
        file.delete();
        System.out.println("Deleted " + file.getName() + " because it was an empty file");
        continue;
      }
      try {
        ZipFile zipFile = new ZipFile(file);
      } catch (IOException ex) {
        file.delete();
        System.out.println("Deleted " + file.getName() + " because of " + ex.getCause());
      }
    }
  }

  @Override
  public String getDescription() {
    return "Deletes any file that either has a file length of 0 or isn't a valid ZipFile";
  }

}
